termin  v2.1  CPLDP-8用端末ソフト 説明書  omiokone著

terminはCPLDP-8をシリアル接続のWindows PCから操作するための端末ソフト。

1. インストール
  termin.exeを適当なフォルダに置く。
  termin.exeのショートカットを作る。
  ショートカットを右クリックしプロパティを開く。
  ショートカットタブのリンク先は例えば以下のようになっているはず。
    "C:\Program Files\termin\termin.exe"
  ここに以下の例のように引数3つを追加。
    "COM1: baud=19200 data=8 parity=N stop=1" "c:\pdp8" "35"
  1つ目の引数はポート指定で、COM1はCPLDP-8を接続しているポート名にする。
  2つ目の引数はファイルを開くダイアログの既定のフォルダ名で、CPLDP-8に転送する
  ファイルを置く実在のフォルダ名を指定。
  3つ目の引数はテキストファイルを送信する時の文字の時間間隔(msec)。

2. アンインストール
  termin.exeを削除する。レジストリは使用していない。

3. 起動と操作
  1.で作ったショートカットから起動。
  
  メニュー
  Exit           終了。
  Send
    Raw    File  ファイルをそのまま送信。
    Binary File  ファイルのtrailer(末尾の80Hの連続)を除いて送信。
    Text   File  ファイルの各文字のMSBを1にし、文字間に指定の間隔をつけて送信。
                 Line Feedは送信しない。
    End          上の送信を強制的に終了。
  Receive
    Raw    File  ファイルをそのまま受信。
    Text   File  各文字のMSBはマスクされ0にして保存。
    End          上のファイル受信はEndで終了するまで行われる。
  Clear          画面消去

  [Ctrl]キーの併用は [Ctrl]+[@](00) [Ctrl]+[^](1E) [Ctrl]+[_](1F) が使えない。
  もし[Send]や[Recieve]の項目が無効になっている場合は前のファイルが開いたままに
  なっているので[End]で閉じる。

4. WindowsCE版
  WinCEフォルダの中から使用機種のCPUに合うものをtermin.exeに名前を変更して使用。
  Windows版と違い第1引数は"COM1:"のようなポート指定のみで、ボーレイト等は指定し
  ても無視される。

5. フォントの変更
  昔のWindowsでも使える既定のCourier Newを他の等幅フォントに変更可能。
  ショートカットに第4引数 "Consolas" などを指定。
  Mark ZanzigによるTeleprinter Bold (TELE_B.TTF)を入手して\WINDOWS\Fontsに入れ
  "Teleprinter Bold"指定でテレタイプ風にできる。

6. 文字転送の問題
  紙テープ版FOCALやBASICにプログラムのテキストを送信するとエラーが起こる。これ
  らは低速テレタイプ用で、割り込みで無制限にバッファへ取り込むためハードフロー
  制御が役に立たない。転送速度を遅くすることで解決した。
  TeraTermのような文字間隔と行末時間の指定が理想だが、ソフトによって最適時間が
  異なり煩雑なため文字間隔のみにした。

7. コンパイル
  Visual Stdioでコンパイルする場合
  プロジェクトプロパティ > 構成プロパティ > 全般 > 文字セット > なし
  プロジェクトプロパティ > 構成プロパティ > C/C++ > コード生成 >
  ランタイムライブラリ > マルチスレッド(/MT)
  に指定。

8. 開発の経緯
  PDP-8用の端末ソフトには以下の機能が必要。
  a. 多くのソフトは7bit mark parityで文字入出力を行う。一方バイナリは8bit転送。
  b. バイナリファイルを生で(Xmodem等使わず)転送。
  c. 6.で述べた文字転送速度の設定。
  d. CPLDP-8では4K FORTRANなどでバイナリ末尾の80Hをカットする。
  e. CPLDP-8ではバッファなしで19200baud転送をするため1byte毎にCTSをチェックする
     必要がある。
  これら全てを満たすソフトは存在しないため自前の古いコードを流用して開発した。
  WindowsCE版と共用するためoverlapped I/Oは使わなかったが、最近のPCでの使用に
  無理があるためv2.1で全面的に書き直した。
